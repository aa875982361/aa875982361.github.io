<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="个人学习笔记，仅供本人复习">
<meta property="og:type" content="website">
<meta property="og:title" content="叶落林间">
<meta property="og:url" content="http://nisonfuture.cn/page/3/index.html">
<meta property="og:site_name" content="叶落林间">
<meta property="og:description" content="个人学习笔记，仅供本人复习">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="叶落林间">
<meta name="twitter:description" content="个人学习笔记，仅供本人复习">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://nisonfuture.cn/page/3/"/>





  <title>叶落林间</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">叶落林间</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">你只有非常努力，才能看起来毫不费力</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Kategorien
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://nisonfuture.cn/2018/05/19/MarginTop 为何影响父元素的 MarginTop/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pling Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="叶落林间">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/19/MarginTop 为何影响父元素的 MarginTop/" itemprop="url">MarginTop 为何影响父元素的 MarginTop</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-19T00:00:00+08:00">
                2018-05-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/programming/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在做弹窗的时候发现一个有趣的问题：<br>子元素用margin-top 将父元素顶下来了 ，并没有起到理想的效果，子元素相对于父元素顶部 XXXXpx<br>如下图：</p>
<p><img src="https://www.github.com/aa875982361/plingWeb/raw/master/markdown/1526697876549.jpg" alt="margin-top问题"></p>
<p>红色边框 父元素 css：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">position</span>: <span class="selector-tag">relative</span>;</span><br><span class="line"><span class="selector-tag">width</span>: 5<span class="selector-class">.5rem</span>;</span><br><span class="line"><span class="selector-tag">height</span>: 6<span class="selector-class">.8rem</span>;</span><br><span class="line"><span class="selector-tag">background</span>: <span class="selector-tag">white</span>;</span><br><span class="line"><span class="selector-tag">border-radius</span>: 0<span class="selector-class">.12rem</span>;</span><br></pre></td></tr></table></figure>
<p>绿色边框 第一个子元素 css ：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">margin</span>: 0 <span class="selector-tag">auto</span>;</span><br><span class="line">   <span class="selector-tag">margin-top</span>: 0<span class="selector-class">.47rem</span>;</span><br><span class="line">   <span class="selector-tag">margin-bottom</span>: 0<span class="selector-class">.23rem</span>;</span><br><span class="line">   <span class="selector-tag">font-family</span>: <span class="selector-tag">PingFang-SC-Medium</span>;</span><br><span class="line">   <span class="selector-tag">font-size</span>: 0<span class="selector-class">.3rem</span>;</span><br><span class="line">   <span class="selector-tag">font-weight</span>: <span class="selector-tag">normal</span>;</span><br><span class="line">   <span class="selector-tag">font-stretch</span>: <span class="selector-tag">normal</span>;</span><br><span class="line">   <span class="selector-tag">line-height</span>: 0<span class="selector-class">.46rem</span>;</span><br><span class="line">   <span class="selector-tag">letter-spacing</span>: 0<span class="selector-tag">rem</span>;</span><br><span class="line">   <span class="selector-tag">color</span>: <span class="selector-id">#131313</span>;</span><br><span class="line">   <span class="selector-tag">text-align</span>: <span class="selector-tag">center</span>;</span><br></pre></td></tr></table></figure>
<p>父元素并没有设置margin-top<br>但是 却又margin-top的效果<br>上网找了一下资料发现 这个 居然是 <strong>==CSS2.1盒模型规范==</strong></p>
<p>CSS2.1的盒模型中规定的内容——<a href="http://www.w3.org/TR/CSS21/box.html#collapsing-margins" target="_blank" rel="noopener">Collapsing margins</a>：</p>
<blockquote>
<p>In this specification, the expression collapsing margins means that adjoining margins (no non-empty content, padding or border areas or clearance separate them) of two or more boxes (which may be next to one another or nested) combine to form a single margin. 所有毗邻的两个或更多盒元素的margin将会合并为一个margin共享之。毗邻的定义为：同级或者嵌套的盒元素，并且它们之间没有非空内容、Padding或Border分隔。</p>
</blockquote>
<h3 id="这就是原因了。“嵌套”的盒元素也算“毗邻”，也会-Collapsing-Margins。"><a href="#这就是原因了。“嵌套”的盒元素也算“毗邻”，也会-Collapsing-Margins。" class="headerlink" title="这就是原因了。“嵌套”的盒元素也算“毗邻”，也会 Collapsing Margins。"></a>这就是原因了。“嵌套”的盒元素也算“毗邻”，也会 Collapsing Margins。</h3><p>这个问题的避免方法很多，只要破坏它出现的条件就行。给 Outer Div 加上 padding/border，或者给 Outer Div / Inner Div 设置为 float/position:absolute(CSS2.1规定浮动元素和绝对定位元素不参与Margin折叠)。 　　更多信息，关于不同值的margin折叠后表现的计算方法等等，可自行查阅W3C的CSS2.1规范：<a href="http://www.w3.org/TR/CSS21/box.html#collapsing-margins" target="_blank" rel="noopener">Collapsing margins</a>。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://nisonfuture.cn/2018/05/14/数字取整/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pling Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="叶落林间">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/14/数字取整/" itemprop="url">数字取整</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-14T00:00:00+08:00">
                2018-05-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/programming/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>一、直接取整</p>
<ol>
<li>==parseInt(number)==<br>这大概是取整最常用的方法了，因为parseInt()不是只能处理Number类型，还可以处理字符串类型的。<br>parseInt()处理在处理字符串时，会从第一个不是空格的字符开始处理。如果第一个不是数字字符或者负号，则返回NaN；如果是数字字符，则会一直处理到不是数字字符为止。<br>注意，parseInt()可以识别各种整数格式（十进制，八进制和十六进制）。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> </span><br><span class="line">    num1 = <span class="built_in">parseInt</span>(<span class="string">"2015nov"</span>),  <span class="comment">//2015</span></span><br><span class="line">    num2 = <span class="built_in">parseInt</span>(<span class="string">""</span>),  <span class="comment">//NaN</span></span><br><span class="line">    num3 = <span class="built_in">parseInt</span>(<span class="string">"0xA"</span>),  <span class="comment">//10(十六进制)</span></span><br><span class="line">    num4 = <span class="built_in">parseInt</span>(<span class="number">20.15</span>),  <span class="comment">//20</span></span><br><span class="line">    num5 = <span class="built_in">parseInt</span>(<span class="number">-20.15</span>),  <span class="comment">//-20</span></span><br><span class="line">    num6 = <span class="built_in">parseInt</span>(<span class="string">"070"</span>);  <span class="comment">//56(八进制数)</span></span><br></pre></td></tr></table></figure>
<ol>
<li>~~number<br>所有取整之中最快的，位运算，一如既往的快。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num1 = ~~<span class="number">20.15</span>,  <span class="comment">//20</span></span><br><span class="line">    num2 = ~~(<span class="number">-20.15</span>);  <span class="comment">//-20</span></span><br></pre></td></tr></table></figure>
<p>3.number^0</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num1 = <span class="number">20.15</span>^<span class="number">0</span>,  <span class="comment">//20</span></span><br><span class="line">    num2 = (<span class="number">-20.15</span>)^<span class="number">0</span>;  <span class="comment">//-20</span></span><br></pre></td></tr></table></figure>
<p>4.number&lt;&lt;0</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num1 = <span class="number">20.15</span> &lt;&lt; <span class="number">0</span>,  <span class="comment">//20</span></span><br><span class="line">    num2 = (<span class="number">-20.15</span>) &lt;&lt; <span class="number">0</span>,  <span class="comment">//-20</span></span><br></pre></td></tr></table></figure>
<p>二、计算取整</p>
<p>1.四舍五入Math.round(number)<br>Math.round()是Math对象中的一个函数，将数值四舍五入为最接近的整数。现实中很少有用到负数的四舍五入的，但是我们也可以看几个负数的例子。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num1 = <span class="built_in">Math</span>.round(<span class="number">20.1</span>),  <span class="comment">//20</span></span><br><span class="line">    num2 = <span class="built_in">Math</span>.round(<span class="number">20.5</span>),  <span class="comment">//21</span></span><br><span class="line">    num3 = <span class="built_in">Math</span>.round(<span class="number">20.9</span>),  <span class="comment">//21</span></span><br><span class="line">    num4 = <span class="built_in">Math</span>.round(<span class="number">-20.1</span>),  <span class="comment">//-20</span></span><br><span class="line">    num5 = <span class="built_in">Math</span>.round(<span class="number">-20.5</span>),  <span class="comment">//-20 注意这里是-20而不是-21</span></span><br><span class="line">    num6 = <span class="built_in">Math</span>.round(<span class="number">-20.9</span>);  <span class="comment">//-21</span></span><br></pre></td></tr></table></figure>
<p>2.向上取整Math.ceil(number)<br>Math.ceil()取向上最接近的整数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num1 = <span class="built_in">Math</span>.ceil(<span class="number">20.1</span>),  <span class="comment">//21</span></span><br><span class="line">    num2 = <span class="built_in">Math</span>.ceil(<span class="number">20.5</span>),  <span class="comment">//21</span></span><br><span class="line">    num3 = <span class="built_in">Math</span>.ceil(<span class="number">20.9</span>),  <span class="comment">//21</span></span><br><span class="line">    num4 = <span class="built_in">Math</span>.ceil(<span class="number">-20.1</span>),  <span class="comment">//-20</span></span><br><span class="line">    num5 = <span class="built_in">Math</span>.ceil(<span class="number">-20.5</span>),  <span class="comment">//-20</span></span><br><span class="line">    num6 = <span class="built_in">Math</span>.ceil(<span class="number">-20.9</span>);  <span class="comment">//-20</span></span><br></pre></td></tr></table></figure>
<p>3.向下取整Math.floor(number)<br>Math.floor()`取向下最接近的整数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var num1 = Math.floor(20.1),  //20</span><br><span class="line">    num2 = Math.floor(20.5),  //20</span><br><span class="line">    num3 = Math.floor(20.9),  //20</span><br><span class="line">    num4 = Math.floor(-20.1),  //-21</span><br><span class="line">    num5 = Math.floor(-20.5),  //-21</span><br><span class="line">    num6 = Math.floor(-20.9),  //-21</span><br></pre></td></tr></table></figure>
<p>参考链接：<a href="https://www.jianshu.com/p/a3202bc3f7a4" target="_blank" rel="noopener">JS中数字取整</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://nisonfuture.cn/2018/05/07/react router 嵌套路由/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pling Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="叶落林间">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/07/react router 嵌套路由/" itemprop="url">react router 嵌套路由</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-07T00:00:00+08:00">
                2018-05-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/programming/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>刚看了一下资料，发现react router 的路由嵌套，在react router V4 的版本下，使用还是比较简单的，我在这就不详细叙述了，用代码说话</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">RouterConfig</span>(<span class="params">&#123; history, app &#125;</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// const routerData = getRouterData(app);</span></span><br><span class="line">    <span class="comment">// const UserLayout = routerData['/user'].component;</span></span><br><span class="line">    <span class="keyword">let</span> male=<span class="string">"btn"</span>;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;LocaleProvider locale=&#123;enUS&#125;&gt;</span><br><span class="line">            &lt;ConnectedRouter history=&#123;history&#125;&gt;</span><br><span class="line">                &lt;div  style=&#123;&#123;<span class="attr">width</span>: <span class="string">'100%'</span>,<span class="attr">height</span>: <span class="string">'100vh'</span>&#125;&#125;&gt;</span><br><span class="line">                  &lt;h1 className=&#123;<span class="string">` <span class="subst">$&#123;styles[<span class="string">`my<span class="subst">$&#123;male&#125;</span>`</span>]&#125;</span>`</span>&#125;&gt;我是爸爸&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">                  &lt;div style=&#123;&#123; width: 300, height: 500, background: "red"&#125;&#125;&gt;</span></span><br><span class="line"><span class="regexp">                    &lt;Switch&gt;</span></span><br><span class="line"><span class="regexp">                        &lt;Route path="/</span><span class="string">" exact  component=&#123;HomePage&#125; /&gt;</span></span><br><span class="line"><span class="string">                        &lt;Route path="</span>/children<span class="string">"  component=&#123;ChlidrenPage&#125; /&gt;</span></span><br><span class="line"><span class="string">                    &lt;/Switch&gt;</span></span><br><span class="line"><span class="string">                  &lt;/div&gt;</span></span><br><span class="line"><span class="string">                  &lt;h1&gt;我是爸爸&lt;/h1&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/ConnectedRouter&gt;</span></span><br><span class="line"><span class="string">        &lt;/LocaleProvider&gt;</span></span><br><span class="line"><span class="string">    );</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<p>核心代码： </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Switch&gt;</span><br><span class="line">  &lt;Route path=<span class="string">"/"</span> exact  component=&#123;HomePage&#125; /&gt;</span><br><span class="line">  &lt;Route path=<span class="string">"/children"</span>  component=&#123;ChlidrenPage&#125; /&gt;</span><br><span class="line">&lt;<span class="regexp">/Switch&gt;</span></span><br></pre></td></tr></table></figure>
<p>其中switch 就像我们平时用的 switch 一样，但是这个是用/做了分割匹配的， 举几个例子：</p>
<ul>
<li>/aaa : 没有匹配 对应的子组件不显示</li>
<li>/: 匹配到 显示homePage </li>
<li>/chlidren:  匹配到 显示chlidrenPage  </li>
<li>/chlidren/dddd:  匹配到 显示chlidrenPage  </li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://nisonfuture.cn/2018/05/06/Object-keys/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pling Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="叶落林间">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/06/Object-keys/" itemprop="url">Object-keys</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-06T00:00:00+08:00">
                2018-05-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/programming/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今天看antd pro 的代码的时候看到有个用法： Object.keys();</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.keys(routerConfig).forEach(<span class="function">(<span class="params">path</span>) =&gt;</span> &#123;</span><br><span class="line">       <span class="comment">// Regular match item name</span></span><br><span class="line">       <span class="comment">// eg.  router /user/:id === /user/chen</span></span><br><span class="line">       <span class="keyword">const</span> pathRegexp = pathToRegexp(path);</span><br><span class="line">       <span class="keyword">const</span> menuKey = <span class="built_in">Object</span>.keys(menuData).find(<span class="function"><span class="params">key</span> =&gt;</span> pathRegexp.test(<span class="string">`<span class="subst">$&#123;key&#125;</span>`</span>));</span><br><span class="line">       <span class="keyword">let</span> menuItem = &#123;&#125;;</span><br><span class="line">       <span class="comment">// If menuKey is not empty</span></span><br><span class="line">       <span class="keyword">if</span> (menuKey) &#123;</span><br><span class="line">           menuItem = menuData[menuKey];</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">let</span> router = routerConfig[path];</span><br><span class="line">       router = &#123;</span><br><span class="line">           ...router,</span><br><span class="line">           name: router.name || menuItem.name,</span><br><span class="line">           authority: router.authority || menuItem.authority,</span><br><span class="line">       &#125;;</span><br><span class="line">       routerData[path] = router;</span><br><span class="line">   &#125;);</span><br><span class="line">   <span class="keyword">return</span> routerData;</span><br></pre></td></tr></table></figure>
<p>但是对这个方法不太了解，所以特意查找了一下资料；</p>
<h2 id="Object-keys-obj"><a href="#Object-keys-obj" class="headerlink" title="Object.keys(obj)"></a>Object.keys(obj)</h2><p>参数： 一个object<br>返回： 一个数组，其元素是与直接在其上找到的可枚举属性对应的字符串object。这些属性的排序与通过手动循环对象的属性给出的顺序相同。</p>
<p>其实我也没看懂，我们来看个例子吧：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// simple array</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>];</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.keys(arr)); <span class="comment">// console: ['0', '1', '2']</span></span><br><span class="line"><span class="comment">// 简单数组 返回的是元素对应的序号</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// array like object</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123; <span class="number">0</span>: <span class="string">'a'</span>, <span class="number">1</span>: <span class="string">'b'</span>, <span class="number">2</span>: <span class="string">'c'</span> &#125;;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.keys(obj)); <span class="comment">// console: ['0', '1', '2']</span></span><br><span class="line"><span class="comment">// 类似数组的对象，返回的值 是对应的 key </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// array like object with random key ordering</span></span><br><span class="line"><span class="keyword">var</span> anObj = &#123; <span class="number">100</span>: <span class="string">'a'</span>, <span class="number">2</span>: <span class="string">'b'</span>, <span class="number">7</span>: <span class="string">'c'</span> &#125;;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.keys(anObj)); <span class="comment">// console: ['2', '7', '100']</span></span><br><span class="line"><span class="comment">// 这里返回的也是key 但是排列方式 是 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// getFoo is a property which isn't enumerable</span></span><br><span class="line"><span class="keyword">var</span> myObj = <span class="built_in">Object</span>.create(&#123;&#125;, &#123;</span><br><span class="line">  getFoo: &#123;</span><br><span class="line">    value: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">this</span>.foo; &#125;</span><br><span class="line">  &#125; </span><br><span class="line">&#125;);</span><br><span class="line">myObj.foo = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.keys(myObj)); <span class="comment">// console: ['foo']</span></span><br></pre></td></tr></table></figure>
<p>如果你想要所有的属性，即使是非枚举类型，请参阅<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyNames" target="_blank" rel="noopener">Object.getOwnPropertyNames()</a>。</p>
<h2 id="注意"><a href="#注意" class="headerlink" title="注意"></a><strong>注意</strong></h2><p>在ES5中，如果这个方法的参数不是一个对象（一个基元），那么它会导致一个tagsError。在ES2015中，非对象参数将被<strong>强制转换为对象</strong>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.keys(<span class="string">'foo'</span>);</span><br><span class="line"><span class="comment">// tagsError: "foo" is not an object (ES5 code)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.keys(<span class="string">'foo'</span>);</span><br><span class="line"><span class="comment">// ["0", "1", "2"]                   (ES2015 code)</span></span><br></pre></td></tr></table></figure>
<p>如果需要支持比较旧的环境，主要添加兼容支持，可以将keys 的实现方式添加到代码中：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// From https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">Object</span>.keys) &#123;</span><br><span class="line">  <span class="built_in">Object</span>.keys = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="meta">    'use strict'</span>;</span><br><span class="line">    <span class="keyword">var</span> hasOwnProperty = <span class="built_in">Object</span>.prototags.hasOwnProperty,</span><br><span class="line">        hasDontEnumBug = !(&#123; <span class="attr">toString</span>: <span class="literal">null</span> &#125;).propertyIsEnumerable(<span class="string">'toString'</span>),</span><br><span class="line">        dontEnums = [</span><br><span class="line">          <span class="string">'toString'</span>,</span><br><span class="line">          <span class="string">'toLocaleString'</span>,</span><br><span class="line">          <span class="string">'valueOf'</span>,</span><br><span class="line">          <span class="string">'hasOwnProperty'</span>,</span><br><span class="line">          <span class="string">'isPrototagsOf'</span>,</span><br><span class="line">          <span class="string">'propertyIsEnumerable'</span>,</span><br><span class="line">          <span class="string">'constructor'</span></span><br><span class="line">        ],</span><br><span class="line">        dontEnumsLength = dontEnums.length;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (tagsof obj !== <span class="string">'function'</span> &amp;&amp; (tagsof obj !== <span class="string">'object'</span> || obj === <span class="literal">null</span>)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> tagsError(<span class="string">'Object.keys called on non-object'</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> result = [], prop, i;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (prop <span class="keyword">in</span> obj) &#123;</span><br><span class="line">        <span class="keyword">if</span> (hasOwnProperty.call(obj, prop)) &#123;</span><br><span class="line">          result.push(prop);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (hasDontEnumBug) &#123;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; dontEnumsLength; i++) &#123;</span><br><span class="line">          <span class="keyword">if</span> (hasOwnProperty.call(obj, dontEnums[i])) &#123;</span><br><span class="line">            result.push(dontEnums[i]);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我看这个的实现方式，我能理解一部分，但是不知道 ==propertyIsEnumerable== 这个是什么，所以特意上网找了下资料。</p>
<p>==PropertyIsEnumerable== ：<strong>检测属性是否可用 for…in 枚举</strong></p>
<p>==Netmad==觉得in, hasOwnProperty和propertyIsEnumerable是逐渐增强的关系, 返回true的条件逐渐苛刻：</p>
<ul>
<li>in: 只要对象包含某个属性就返回true, 包含原型链上的属性</li>
<li>hasOwnProperty: 首先满足in, 其次属性不属于原型链</li>
<li>propertyIsEnumerable: 首先满足hasOwnProperty，其次该属性未经由Object.defineProperty定义为不可列举</li>
</ul>
<p>参考链接： <a href="https://www.zhihu.com/question/21907133" target="_blank" rel="noopener">hasOwnProperty 和 propertyIsEnumerable 的区别？</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://nisonfuture.cn/2018/05/06/react-router history原理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pling Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="叶落林间">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/06/react-router history原理/" itemprop="url">react-router history原理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-06T00:00:00+08:00">
                2018-05-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/programming/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>目前，==react==的生态越来越丰富，像==flux redux react-router==已经被越来越多的使用，本文就==react-router==的内部实现进行分析。文章主要包含两大部分: 一是对==react-router==赖以依存的==history==进行研究；二是分析==react-router==是如何实现URL与UI同步的。</p>
<p><strong>1.History</strong></p>
<ul>
<li><p>老浏览器的history: 主要通过hash来实现，对应createHashHistory</p>
</li>
<li><p>高版本浏览器: 通过html5里面的history，对应createBrowserHistory</p>
</li>
<li><p>node环境下: 主要存储在memeory里面，对应createMemoryHistory</p>
</li>
</ul>
<p><strong>内部createHistory实现：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 内部的抽象实现</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createHistory</span>(<span class="params">options=&#123;&#125;</span>) </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    listenBefore, <span class="comment">// 内部的hook机制，可以在location发生变化前执行某些行为，AOP的实现</span></span><br><span class="line">    listen, <span class="comment">// location发生改变时触发回调</span></span><br><span class="line">    transitionTo, <span class="comment">// 执行location的改变</span></span><br><span class="line">    push, <span class="comment">// 改变location</span></span><br><span class="line">    replace,</span><br><span class="line">    go,</span><br><span class="line">    goBack,</span><br><span class="line">    goForward,</span><br><span class="line">    createKey, <span class="comment">// 创建location的key，用于唯一标示该location，是随机生成的</span></span><br><span class="line">    createPath,</span><br><span class="line">    createHref,</span><br><span class="line">    createLocation, <span class="comment">// 创建location</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>createLocation方法:</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createLocation</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    pathname, <span class="comment">// url的基本路径</span></span><br><span class="line">    search, <span class="comment">// 查询字段</span></span><br><span class="line">    hash, <span class="comment">// url中的hash值</span></span><br><span class="line">    state, <span class="comment">// url对应的state字段</span></span><br><span class="line">    action, <span class="comment">// 分为push、replace、pop三种</span></span><br><span class="line">    key <span class="comment">// 生成方法为: Math.random().toString(36).substr(2, length)</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>三种方法各自执行URL前进的方式：</strong></p>
<ul>
<li><p>createBrowserHistory: pushState、replaceState-</p>
</li>
<li><p>createHashHistory: location.hash=*** location.replace()</p>
</li>
<li><p>createMemoryHistory: 在内存中进行历史记录的存储</p>
</li>
</ul>
<p>伪代码实现:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// createBrowserHistory(HTML5)中的前进实现</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">finishTransition</span>(<span class="params">location</span>) </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">const</span> historyState = &#123; key &#125;;</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">if</span> (location.action === <span class="string">'PUSH'</span>) ) &#123;</span><br><span class="line">    <span class="built_in">window</span>.history.pushState(historyState, <span class="literal">null</span>, path);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.history.replaceState(historyState, <span class="literal">null</span>, path)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// createHashHistory的内部实现</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">finishTransition</span>(<span class="params">location</span>) </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">if</span> (location.action === <span class="string">'PUSH'</span>) ) &#123;</span><br><span class="line">    <span class="built_in">window</span>.location.hash = path;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.location.replace(</span><br><span class="line">    <span class="built_in">window</span>.location.pathname + <span class="built_in">window</span>.location.search + <span class="string">'#'</span> + path</span><br><span class="line">  );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// createMemoryHistory的内部实现</span></span><br><span class="line">entries = [];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">finishTransition</span>(<span class="params">location</span>) </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">switch</span> (location.action) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'PUSH'</span>:</span><br><span class="line">      entries.push(location);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'REPLACE'</span>:</span><br><span class="line">      entries[current] = location;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>检测URL回退</strong></p>
<ul>
<li>createBrowserHistory: popstate</li>
<li>createHashHistory: hashchange</li>
<li>createMemoryHistory: 因为是在内存中操作，跟浏览器没有关系，不涉及UI层面的事情，所以可以直接进行历史信息的回退</li>
</ul>
<p>伪代码实现如下:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// createBrowserHistory(HTML5)中的后退检测</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">startPopStateListener</span>(<span class="params">&#123; transitionTo &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">popStateListener</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    transitionTo( getCurrentLocation(event.state) );</span><br><span class="line">  &#125;</span><br><span class="line">  addEventListener(<span class="built_in">window</span>, <span class="string">'popstate'</span>, popStateListener);</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// createHashHistory的后退检测</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">startPopStateListener</span>(<span class="params">&#123; transitionTo &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">hashChangeListener</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    transitionTo( getCurrentLocation(event.state) );</span><br><span class="line">  &#125;</span><br><span class="line">  addEventListener(<span class="built_in">window</span>, <span class="string">'hashchange'</span>, hashChangeListener);</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// createMemoryHistory的内部实现</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">go</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (n) &#123;</span><br><span class="line">    ...</span><br><span class="line">    current += n;</span><br><span class="line">  <span class="keyword">const</span> currentLocation = getCurrentLocation();</span><br><span class="line">  <span class="comment">// change action to POP</span></span><br><span class="line">  history.transitionTo(&#123; ...currentLocation, <span class="attr">action</span>: POP &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="state的存储"><a href="#state的存储" class="headerlink" title="state的存储"></a><strong>state的存储</strong></h3><p>为了维护state的状态，将其存储在sessionStorage里面：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// createBrowserHistory/createHashHistory中state的存储</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">saveState</span>(<span class="params">key, state</span>) </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="built_in">window</span>.sessionStorage.setItem(createKey(key), <span class="built_in">JSON</span>.stringify(state));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readState</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  json = <span class="built_in">window</span>.sessionStorage.getItem(createKey(key));</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">JSON</span>.parse(json);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// createMemoryHistory仅仅在内存中，所以操作比较简单</span></span><br><span class="line"><span class="keyword">const</span> storage = createStateStorage(entries); <span class="comment">// storage = &#123;entry.key: entry.state&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">saveState</span>(<span class="params">key, state</span>) </span>&#123;</span><br><span class="line">  storage[key] = state</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readState</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> storage[key]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="react-router的基本原理"><a href="#react-router的基本原理" class="headerlink" title="react-router的基本原理"></a><strong>react-router的基本原理</strong></h3><p>一句话：实现URL与UI界面的同步。其中在react-router中，==URL==对应==Location==对象，而UI是由==react components==来决定的，这样就转变成==location==与==components==之间的同步问题。</p>
<p><img src="https://www.github.com/aa875982361/plingWeb/raw/master/markdown/1525598996592.jpg" alt="基本原理"></p>
<h3 id="react-router的具体实现"><a href="#react-router的具体实现" class="headerlink" title="react-router的具体实现"></a><strong>react-router的具体实现</strong></h3><p>react-router在==history==库的基础上，实现了URL与UI的同步，分为两个层次来描述具体的实现。</p>
<h4 id="组件层面描述具体实现过程"><a href="#组件层面描述具体实现过程" class="headerlink" title="组件层面描述具体实现过程"></a>组件层面描述具体实现过程</h4><p>在react-router中最主要的component是Router RouterContext Link，history库起到了中间桥梁的作用。</p>
<p><img src="https://www.github.com/aa875982361/plingWeb/raw/master/markdown/1525599073031.jpg" alt="组件层面的实现过程"></p>
<h4 id="API层面描述具体实现过程"><a href="#API层面描述具体实现过程" class="headerlink" title="API层面描述具体实现过程"></a>API层面描述具体实现过程</h4><p>为了简单说明，只描述使用browserHistory的实现，hashHistory的实现过程是类似的，就不在说明。</p>
<p><img src="https://www.github.com/aa875982361/plingWeb/raw/master/markdown/1525599115412.jpg" alt=" api层面的实现过程"></p>
<h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a><strong>结语</strong></h3><p>目前==react-router==在项目中已有大量实践，其优点可以总结如下:</p>
<p>风格: 与React融为一体,专为react量身打造，编码风格与react保持一致，例如路由的配置可以通过component来实现</p>
<ul>
<li>简单: 不需要手工维护路由state，使代码变得简单</li>
<li>强大: 强大的路由管理机制，体现在如下方面<ul>
<li>路由配置: 可以通过组件、配置对象来进行路由的配置</li>
<li>路由切换: 可以通过\<link> Redirect进行路由的切换</li>
<li>路由加载: 可以同步记载，也可以异步加载，这样就可以实现按需加载</li>
</ul>
</li>
<li>使用方式: 不仅可以在浏览器端的使用，而且可以在服务器端的使用</li>
</ul>
<p>当然react-router的缺点就是API不太稳定，在升级版本的时候需要进行代码变动。</p>
<p>参考链接： <a href="http://zhenhua-lee.github.io/react/history.html" target="_blank" rel="noopener">react-router的实现原理</a><br>参考链接： <a href="https://zhuanlan.zhihu.com/p/26942101" target="_blank" rel="noopener">前端进阶之路</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://nisonfuture.cn/2018/05/06/React Router 简介/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pling Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="叶落林间">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/06/React Router 简介/" itemprop="url">React Router 简介</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-06T00:00:00+08:00">
                2018-05-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/programming/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>这篇文章主要是讲怎样 react router 是怎样的，并没有介绍到底层的实现机制，仅供未了解过的同学参考。</p>
</blockquote>
<h2 id="弄清原理之React-Router"><a href="#弄清原理之React-Router" class="headerlink" title="弄清原理之React Router"></a>弄清原理之React Router</h2><h3 id="1-概念"><a href="#1-概念" class="headerlink" title="1. 概念"></a>1. 概念</h3><p>在web应用开发过程中，路由系统是不可或缺的一部分，路由简单来说就是当url发生变化时，web界面也会随之改变。react 也有自己的路由系统，那就是 react router 路由系统。</p>
<h3 id="2-基本原理"><a href="#2-基本原理" class="headerlink" title="2. 基本原理"></a>2. 基本原理</h3><p>url  和ui 是意义对应的关系，记当你输入Url 时，就回渲染对应 react component</p>
<p><img src="https://www.github.com/aa875982361/plingWeb/raw/master/markdown/1525588546705.jpg" alt="基本原理"></p>
<p>接下来然我们看看组件层面的实现原理</p>
<p><img src="https://www.github.com/aa875982361/plingWeb/raw/master/markdown/1525588577206.jpg" alt="实现原理"></p>
<p>以browserHistory(一种history类型:一个 history 知道如何去监听浏览器地址栏的变化， 并解析这个 URL 转化为 location 对象)为例 :</p>
<ul>
<li>browserHistory进行==路由state==管理,主要通过sessionStorage</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//保存　路由state(router state)</span><br><span class="line">function saveState(key, state) &#123;</span><br><span class="line">  ...</span><br><span class="line">  window.sessionStorage.setItem(createKey(key), JSON.stringify(state));</span><br><span class="line">&#125;</span><br><span class="line">//读取路由state</span><br><span class="line">function readState(key) &#123;</span><br><span class="line">  ...</span><br><span class="line">  json = window.sessionStorage.getItem(createKey(key));</span><br><span class="line">  return JSON.parse(json);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中saveState函数传进来的state是个json对象，如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">route</span>: <span class="string">'/about'</span>&#125; <span class="comment">///假设此时的location为'/about'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>进行路由匹配，最终渲染对应的组件</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> About = React.createClass(&#123;<span class="comment">/*...*/</span>&#125;) <span class="comment">//About 组件</span></span><br><span class="line"><span class="keyword">const</span> Inbox = React.createClass(&#123;<span class="comment">/*...*/</span>&#125;) <span class="comment">//Inbox 组件</span></span><br><span class="line"><span class="keyword">const</span> Home = React.createClass(&#123;<span class="comment">/*...*/</span>&#125;) <span class="comment">//Home组件</span></span><br><span class="line"> render() &#123;</span><br><span class="line">    <span class="keyword">let</span> Child</span><br><span class="line">    <span class="keyword">switch</span> (<span class="keyword">this</span>.state.route) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'/about'</span>: Child = About; <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'/inbox'</span>: Child = Inbox; <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:      Child = Home;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;App&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">        &lt;ul&gt;</span></span><br><span class="line"><span class="regexp">          &lt;li&gt;&lt;a href="#/</span>about<span class="string">"&gt;About&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line">          &lt;li&gt;&lt;a href="#/inbox"&gt;Inbox&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">        &lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">        &lt;Child/</span>&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">React.render(&lt;App /</span>&gt;, <span class="built_in">document</span>.body)</span><br></pre></td></tr></table></figure>
<h3 id="二-React-Router-实践"><a href="#二-React-Router-实践" class="headerlink" title="二. React Router 实践"></a>二. React Router 实践</h3><p>现在有这样的场景，想实现在 <strong>UserCenter Page</strong>(用户中心页面) 点击<strong>写文章</strong>链接后跳转到 <strong>BlogNewed Page</strong> (新建博客页面)的功能。</p>
<p><img src="https://www.github.com/aa875982361/plingWeb/raw/master/markdown/1525589351634.jpg" alt="点击链接后跳转.jpg"></p>
<ol>
<li>于是，首先我们要建立我们的UserCenter Page，因为页面代码不是我们今天的重点，所以不会过多解释。</li>
</ol>
<p>我们先在src/components文件夹下新建文件UserCenter.js，并添加以下代码:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;Link&#125; <span class="keyword">from</span> <span class="string">'react-router'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserCenter</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div className=<span class="string">"row user-info blog-body"</span>&gt;</span><br><span class="line">        &lt;div className=<span class="string">"col-md-3 "</span>&gt;</span><br><span class="line">          ![](images/userPhoto.jpg)</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        &lt;div className=" col-md-4"&gt;</span></span><br><span class="line"><span class="regexp">          &lt;ul&gt;</span></span><br><span class="line"><span class="regexp">            &lt;li&gt;</span></span><br><span class="line"><span class="regexp">              &lt;h3&gt;</span></span><br><span class="line"><span class="regexp">                &lt;Link to="/</span>blogNewed<span class="string">"&gt;</span></span><br><span class="line"><span class="string">                  &lt;span className="</span>iconfont icon-iconxiezuo01<span class="string">"&gt; &lt;/span&gt;</span></span><br><span class="line"><span class="string">                  写文章</span></span><br><span class="line"><span class="string">                &lt;/Link&gt;</span></span><br><span class="line"><span class="string">              &lt;/h3&gt;</span></span><br><span class="line"><span class="string">            &lt;/li&gt;</span></span><br><span class="line"><span class="string">          &lt;/ul&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">    );</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">export default UserCenter;</span></span><br></pre></td></tr></table></figure>
<p>这是一份很简单的代码，其中主要用到的是React Router的Link组件，相当于React版的a标签。<strong>其中”/blogNewed”就是点击该Link后要跳到的目的地址，这个地址会被下面谈及的路由所捕获，然后转向对应的页面</strong></p>
<ol>
<li>想想我们之前只有UserCenter这个页面，之前通过路由进入UserCenter 页面的做法如下：</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*src/index.js*/</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;render&#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;Provider&#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</span><br><span class="line"><span class="keyword">import</span> UserCenter <span class="keyword">from</span> <span class="string">'./components/UserCenter'</span>;</span><br><span class="line">render(</span><br><span class="line">    &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">       &lt;UserCenter/&gt;</span><br><span class="line">    &lt;<span class="regexp">/Provider&gt;,</span></span><br><span class="line"><span class="regexp">    document.getElementById('app')</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure>
<p>如果我们只是UserCenter这个页面的话，这样做也没有什么问题。但是问题是我们这里在UserCenter里面点击相应的链接，需要跳转到/blogNewed页面。如果要实现这个功能，我们就要<strong>引入React Router</strong>了，我们先看代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;render&#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;Provider&#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;Router, Route, browserHistory,IndexRoute&#125; <span class="keyword">from</span> <span class="string">'react-router'</span>;</span><br><span class="line"><span class="comment">/*import App from './components/App';*/</span></span><br><span class="line"><span class="keyword">import</span> UserCenter <span class="keyword">from</span> <span class="string">'./components/UserCenter'</span>;</span><br><span class="line"><span class="keyword">import</span> BlogNewd <span class="keyword">from</span> <span class="string">'./components/BlogNewed'</span>;</span><br><span class="line"></span><br><span class="line">render(</span><br><span class="line">    &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">      &lt;Router history=&#123;browserHistory&#125;&gt;</span><br><span class="line">        &lt;Route path=<span class="string">"/"</span> component=&#123;UserCenter&#125;/&gt;</span><br><span class="line">        &lt;Route path=<span class="string">"/blogNewed"</span> component=&#123;BlogNewd&#125;/&gt;</span><br><span class="line">      &lt;<span class="regexp">/Router&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>Provider&gt;,</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>上面的 Route组件中</p>
<ul>
<li>==path:== 代表用户访问的路径</li>
<li>==component:== 用户访问这个路径的时候，页面将会导向哪里？这里的目的地址就是React的一个组件</li>
</ul>
<p>所以就实现了在 UserCenter Page(用户中心页面) 点击写文章后跳转到 BlogNewed Page (新建博客页面)的功能. <a href="https://github.com/yujuan123/blogsearchengine.git" target="_blank" rel="noopener">上述博客代码</a></p>
<blockquote>
<p>可以看出React Router在路由配置起了很大作用</p>
</blockquote>
<ul>
<li>可以配置路由: 具体做法比如<route path="/" component="{UserCenter}/"></route></li>
<li>可以切换路由:通过Link自由切换</li>
</ul>
<p>其他React Router基础知识：</p>
<ul>
<li><a href="http://zhenhua-lee.github.io/react/history.html" target="_blank" rel="noopener">React Router实现原理</a></li>
<li>React Router <a href="http://zhenhua-lee.github.io/react/history.html" target="_blank" rel="noopener">基本原理</a></li>
<li>React Router的<a href="https://github.com/reactjs/react-router-tutorial/tree/master/lessons" target="_blank" rel="noopener">示例教程</a></li>
</ul>
<p>这篇文章没有讲到怎样在js代码里面去跳转页面，之后了解到再补充</p>
<p>参考链接：<a href="https://www.jianshu.com/p/6f8babea6243" target="_blank" rel="noopener">弄清原理之React Router</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://nisonfuture.cn/2018/05/06/Web App Hybrid App和 Native App的区别/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pling Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="叶落林间">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/06/Web App Hybrid App和 Native App的区别/" itemprop="url">Web App Hybrid App和 Native App的区别</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-06T00:00:00+08:00">
                2018-05-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/programming/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>目前主流应用程序大体分为三类：Web App、Hybrid App、 Native App。</p>
<h3 id="一、Web-App、Hybrid-App、Native-App-纵向对比"><a href="#一、Web-App、Hybrid-App、Native-App-纵向对比" class="headerlink" title="一、Web App、Hybrid App、Native App 纵向对比"></a>一、Web App、Hybrid App、Native App 纵向对比</h3><p>首先，我们来看看什么是 Web App、Hybrid App、 Native App。</p>
<h4 id="1-Web-APP"><a href="#1-Web-APP" class="headerlink" title="1. Web APP"></a>1. Web APP</h4><p>Web App 指采用Html5语言写出的App，不需要下载安装。类似于现在所说的轻应用。生存在浏览器中的应用，基本上可以说是触屏版的网页应用。</p>
<p>优点</p>
<p>（1）开发成本低，<br>（2）更新快，<br>（3）更新无需通知用户，不需要手动升级，<br>（4）能够跨多个平台和终端。</p>
<p>缺点：</p>
<p>（1）临时性的入口<br>（2）无法获取系统级别的通知，提醒，动效等等<br>（3）用户留存率低<br>（4）设计受限制诸多<br>（5）体验较差</p>
<h4 id="2-Hybrid-App"><a href="#2-Hybrid-App" class="headerlink" title="2. Hybrid App"></a>2. Hybrid App</h4><p>Hybrid APP指的是半原生半Web的混合类App。需要下载安装，看上去类似Native App，但只有很少的UI Web View，访问的内容是 Web 。</p>
<p>例如Store里的新闻类APP，视频类APP普遍采取的是Native的框架，Web的内容。</p>
<p>Hybrid App 极力去打造类似于Native App 的体验，但仍受限于技术，网速，等等很多因素。尚不完美。</p>
<h4 id="3-Native-App"><a href="#3-Native-App" class="headerlink" title="3. Native App"></a>3. Native App</h4><p>Native APP 指的是原生程序，一般依托于操作系统，有很强的交互，是一个完整的App，可拓展性强。需要用户下载安装使用。</p>
<p>优点：</p>
<p>（1）打造完美的用户体验<br>（2）性能稳定<br>（3）操作速度快，上手流畅<br>（4）访问本地资源（通讯录，相册）<br>（5）设计出色的动效，转场，<br>（6）拥有系统级别的贴心通知或提醒<br>（7）用户留存率高</p>
<p>缺点：</p>
<p>（1）分发成本高（不同平台有不同的开发语言和界面适配）<br>（2）维护成本高（例如一款App已更新至V5版本，但仍有用户在使用V2， V3， V4版本，需要更多的开发人员维护之前的版本）<br>（3）更新缓慢，根据不同平台，提交–审核–上线 等等不同的流程，需要经过的流程较复杂</p>
<h3 id="二、Web-App、Hybrid-App、Native-App-技术特性"><a href="#二、Web-App、Hybrid-App、Native-App-技术特性" class="headerlink" title="二、Web App、Hybrid App、Native App 技术特性"></a>二、Web App、Hybrid App、Native App 技术特性</h3><p><img src="https://www.github.com/aa875982361/plingWeb/raw/master/markdown/1525586592219.jpg" alt="对比"></p>
<p>由上图可见，Web APP 的开发基于Html5语言。而Html5语言本身又有着不可避免的局限性。正是这些局限性的存在，使得Web App在体验中要逊于Native App。</p>
<h3 id="三、Web-App受限制因素及设计要点"><a href="#三、Web-App受限制因素及设计要点" class="headerlink" title="三、Web App受限制因素及设计要点"></a>三、Web App受限制因素及设计要点</h3><p><img src="https://www.github.com/aa875982361/plingWeb/raw/master/markdown/1525586634685.jpg" alt="受限因素"></p>
<p>相比Native App，Web App体验中受限于以上5个因素：网络环境，渲染性能，平台特性，受限于浏览器，系统限制。</p>
<h4 id="1-网络环境，渲染性能"><a href="#1-网络环境，渲染性能" class="headerlink" title="1. 网络环境，渲染性能"></a><strong>1. 网络环境，渲染性能</strong></h4><p>Web APP对网络环境的依赖性较大，因为Web APP中的H5页面，当用户使用时，去服务器请求显示页面。如果此时用户恰巧遇到网速慢，网络不稳定等其他环境时，用户请求页面的效率大打折扣，在用户使 用中会出现不流畅，断断续续的不良感受。同时，H5技术自身渲染性能较弱：对复杂的图形样式，多样的动效，自定义字体等的支持性不强。</p>
<p>因此，基于网络环境和渲染性能的影响，在设计H5页面时，应注意以下几点：</p>
<p>简化不重要的动画/动效<br>简化复杂的图形文字样式<br>减少页面渲染的频率和次数<br>从下图移动Web版 jing.fm和Native版jing对比后可以看出：Web APP首页去除冗余的功能，回溯本源，只给用户提供了jing.fm最初的本质需求——电台。既符合H5精简功能又达到了突出核心功能的设计原则。无疑给用户眼前一亮的气息。</p>
<p>正如书中《瞬间之美》的一个核心观点：重要的并不是我们提供的信息量有多大，而是我们能否给他们提供真正需要的信息。</p>
<p><img src="https://www.github.com/aa875982361/plingWeb/raw/master/markdown/1525586742550.jpg" alt="jing.fm"></p>
<p>再如：百度最新推出的直达号，以良子健身为例：</p>
<p>从Native App和Web App（百度直达号）的对比中，我们可以看出Native良子以九宫格的形式展现，且属于双重导航，功能入口太多；弊端是用户不知道聚焦在哪里，分散用户 的注意力。而Web版良子整合并减少了导航的入口，增强用户的专注度；界面清爽，整洁，很好地传达了良子本身的寓意——轻松、愉悦、休闲、舒适。</p>
<p><img src="https://www.github.com/aa875982361/plingWeb/raw/master/markdown/1525586826565.jpg" alt="良子健身"></p>
<h4 id="2-受限于浏览器"><a href="#2-受限于浏览器" class="headerlink" title="2. 受限于浏览器"></a><strong>2. 受限于浏览器</strong></h4><p>通常Web App生存于浏览器里，宿主是浏览器。不同的浏览器自身的属性不尽相同，如：浏览器自带的手势，页面切换方式，链接跳转方式，版本兼容问题等等。</p>
<p>例如下图：UC 浏览器和百度浏览器自身支持手势切换页面。手指从左侧滑动页面，返回至上一级。百度手机助手H5页面，顶部Banner支持手势左右滑动切换。这一操作与浏览器自身手势是冲突的。</p>
<p><img src="https://www.github.com/aa875982361/plingWeb/raw/master/markdown/1525586894125.jpg" alt="百度浏览器"></p>
<p>再如，基于浏览器的Web APP在打开新的模块中的页面时，大多会新开窗口来展现。例如用户在使用购物类APP时，浏览每日精选模块时，每当打开新的商品时，默认新开一个窗口。这 样的优劣势显而易见：优势是能够记录用户浏览过的痕迹，浏览过的商品，以便后续横向对比；劣势是过多的页面容易使用户迷失在页面中。</p>
<p>正如Google开发手册里描述：当用户打开一个Web App的时候，他们期待这个应用就像是一个单个应用，而不是一系列网页的结合。然而，什么情况下需要跳转页面，什么情况下在当前页面展示则需要设计师细致考量。</p>
<p><img src="https://www.github.com/aa875982361/plingWeb/raw/master/markdown/1525586926726.jpg" alt="淘宝web"></p>
<p>因此，Web App基于浏览器的特性，从设计角度应该遵循以下了两点：</p>
<p>少用手势，避免与浏览器手势冲突。</p>
<p>减少页面跳转次数，尽量在当前页面显示。</p>
<h4 id="3-系统限制，平台特性"><a href="#3-系统限制，平台特性" class="headerlink" title="3. 系统限制，平台特性"></a><strong>3. 系统限制，平台特性</strong></h4><p>由于Html5语言的技术特性，无法调用系统级别的权限。例如，系统级别的弹窗，系统级别的通知，地理信息，通讯录，语音等等。且与系统的兼容性也会存在一些问题。以上限制通常导致APP的拓展性不强，体验相对较差。例如百度地图：</p>
<p><img src="https://www.github.com/aa875982361/plingWeb/raw/master/markdown/1525587010971.jpg" alt="百度地图对比"><br>Web版地图基于浏览器展现，因此，不能全屏显示地图，给用户的眼界带来局限感；相反，Native 版地图以全屏展现的形式，很好的拓展了用户的视野。整个界面干净简洁，首页去除冗余功能。</p>
<p>在制定路线的体验中，如图：</p>
<p><img src="https://www.github.com/aa875982361/plingWeb/raw/master/markdown/1525587038540.jpg" alt="地图制定路线"></p>
<p>Web 版地图耗费的流量大于Native版，且不能预先缓存离线地图。对于地理位置的判断也是基于宿主浏览器，而非Web地图本身。获取路线后，对于更换到达方式，相对来说是不便利的。</p>
<p>相反，Native 版地图，能够直接访问用户的地理位置，能够很清晰的为用户展现App规划的路线，并能轻松的查看多种路线方案，以便做出符合自己的最佳方案。对于切换公交，走路，自驾等路线方式也是只需一键操作。</p>
<p>Native 版地图相对于 Web版地图增加更多情感化，易用的功能，如：能够记录用户的生活轨迹，记录用户的点滴足迹，能够享受躲避拥堵方案等。而Web版地图基于技术框架，很难实现以上功能，从用户体验角度来看，弱于Native版地图。</p>
<h3 id="四、小结"><a href="#四、小结" class="headerlink" title="四、小结"></a>四、小结</h3><p>综述所述，在设计Web APP时，应当遵循以下几点：</p>
<ol>
<li><strong>简化</strong></li>
</ol>
<ul>
<li>简化不重要的动画/动效</li>
<li>简化复杂的图形文字样式</li>
</ul>
<ol>
<li><strong>少用</strong></li>
</ol>
<ul>
<li>少用手势，避免与浏览器手势冲突</li>
<li>少用弹窗</li>
</ul>
<ol>
<li><strong>减少</strong></li>
</ol>
<ul>
<li>减少页面内容</li>
<li>减少控件数量</li>
<li>减少页面跳转次数，尽量在当前页面显示</li>
</ul>
<ol>
<li><strong>增强</strong></li>
</ol>
<ul>
<li>增强Loading时的趣味性</li>
<li>增强页面主次关系</li>
<li>增强控件复用性</li>
</ul>
<p>参考链接：<a href="http://www.ionic.wang/article-index-id-58.html" target="_blank" rel="noopener">Web App Hybrid App和 Native App的区别</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://nisonfuture.cn/2018/05/05/dva + antd mobile/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pling Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="叶落林间">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/05/dva + antd mobile/" itemprop="url">dva + antd mobile</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-05T00:00:00+08:00">
                2018-05-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/programming/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>写这篇文章主要是想记录一下自己做移动端开发及过程，之所以用antd mobile + dva 主要因为 便捷式开发。其中，dva用来做数据状态管理，因为我们接下来的项目涉及到的页面交互比较多。 另外在移动适配方面，我们打算使用 动态设置rem的方式去做适配，在宽度的布局使用rem 高度自适应，下一篇会说到。</p>
</blockquote>
<h2 id="创建dva-demo应用"><a href="#创建dva-demo应用" class="headerlink" title="创建dva-demo应用"></a>创建dva-demo应用</h2><h3 id="安装-dva-cli"><a href="#安装-dva-cli" class="headerlink" title="安装 dva-cli"></a>安装 dva-cli</h3><blockquote>
<p>你应该会更希望关注逻辑本身，而不是手动敲入一行行代码来构建初始的项目结构，以及配置开发环境。</p>
</blockquote>
<p>那么，首先需要安装的是 dva-cli 。dva-cli 是 dva 的命令行工具，包含 init、new、generate 等功能，目前最重要的功能是可以快速生成项目以及你所需要的代码片段。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g dva-cli</span><br></pre></td></tr></table></figure>
<p>安装完成后，可以通过 dva -v 查看版本，以及 dva -h 查看帮助信息。</p>
<h3 id="创建新应用"><a href="#创建新应用" class="headerlink" title="创建新应用"></a>创建新应用</h3><p>安装完成之后，可以用来创建一个新的应用，取名 myapp 。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dva new myApp --demo</span><br></pre></td></tr></table></figure>
<p>注意一点： –demo 用于创建简单的 demo 级项目，正常项目初始化不加要这个参数。</p>
<p>然后进入项目目录，并启动。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> myApp</span><br><span class="line">$ npm <span class="built_in">start</span></span><br></pre></td></tr></table></figure>
<p>这样就创建了一个简单的dva应用，但是只是基础的东西，</p>
<h2 id="加入antd-mobile"><a href="#加入antd-mobile" class="headerlink" title="加入antd mobile"></a>加入antd mobile</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install antd-mobile --save</span><br></pre></td></tr></table></figure>
<p>这个安装比较简单，只要用一句命令就可以，<strong>但是</strong> 要安装很久，我安装了两次都卡死了，<br>第一次使用yarn 就和原来的 dva demo 好像出现冲突，我不太清楚具体原因，但是想起老师说的，出现问题，就将node_moudle 删掉 重新装一遍。</p>
<p>第二次没用 yarn 就成功装好</p>
<h4 id="简单使用"><a href="#简单使用" class="headerlink" title="简单使用"></a>简单使用</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Button &#125; <span class="keyword">from</span> <span class="string">'antd-mobile'</span>;</span><br><span class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">Button</span>&gt;</span>Start<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span>, mountNode);</span><br></pre></td></tr></table></figure>
<p>引用样式:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &apos;antd-mobile/dist/antd-mobile.css&apos;;  // or &apos;antd-mobile/dist/antd-mobile.less&apos;</span><br></pre></td></tr></table></figure>
<h3 id="使用-babel-plugin-import（推荐）。"><a href="#使用-babel-plugin-import（推荐）。" class="headerlink" title="使用 babel-plugin-import（推荐）。"></a>使用 <a href="https://github.com/ant-design/babel-plugin-import" target="_blank" rel="noopener">babel-plugin-import</a>（推荐）。</h3><p>这个我没用过 是官网说推荐用这个 ，先看看怎么用，</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// .babelrc or babel-loader option</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"plugins"</span>: [</span><br><span class="line">    ["import", &#123; libraryName: "antd-mobile", style: "css" &#125;] // `style: true` 会加载 less 文件</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后只需从 antd-mobile 引入模块即可，无需单独引入样式。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// babel-plugin-import 会帮助你加载 JS 和 CSS</span></span><br><span class="line"><span class="keyword">import</span> &#123; DatePicker &#125; <span class="keyword">from</span> <span class="string">'antd-mobile'</span>;</span><br></pre></td></tr></table></figure>
<p>关于loading 状态的管控，dva有一个插件可以使用，dva-loading</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install dva-loading --save</span><br></pre></td></tr></table></figure>
<p>如果是之前有有过actd pro 的应该知道怎样使用，我在这里也说一下：</p>
<p>首先在index.js 就需要先导入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import createLoading from &apos;dva-loading&apos;;</span><br><span class="line"></span><br><span class="line">const app = dva(&#123;</span><br><span class="line">  history: createHistory(),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 2. Plugins</span><br><span class="line">app.use(createLoading()); // 在初始化之后再使用</span><br></pre></td></tr></table></figure>
<p>使用方式：</p>
<ol>
<li>首先在index.js 注册一个modal （modal文件会在后面有给出）</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2. Model</span></span><br><span class="line"><span class="comment">// Remove the comment and define your model.</span></span><br><span class="line">app.model(<span class="built_in">require</span>(<span class="string">'./models/user'</span>).default);</span><br></pre></td></tr></table></figure>
<ol>
<li>在使用页面： 用dva的connect 将 component 和modal 关联起来</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'dva'</span>;</span><br><span class="line"></span><br><span class="line">@connect(<span class="function">(<span class="params">&#123; user, loading &#125;</span>) =&gt;</span> (&#123;</span><br><span class="line">  user, <span class="comment">// modal 里面的 namespace </span></span><br><span class="line">&#125;))</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br></pre></td></tr></table></figure>
<p>可以通过user 获取到 user 里面的 state 用来控制状态显示</p>
<ol>
<li>通过loading.effects[‘’] 可以获取到异步请求操作的状态，如果是在请求数据，可以通过这个参数来控制显示loading动效，</li>
</ol>
<p><code>`</code> javascript<br>@connect(({ coupon, loading }) =&gt; ({<br>  coupon,<br>  isListLoading: loading.effects[‘coupon/queryPage’],<br>}))<br>class Coupon extends Component {</p>
<p><code>`</code>+</p>
<p>参考链接： <a href="https://github.com/dvajs/dva-docs/blob/master/v1/zh-cn/getting-started.md" target="_blank" rel="noopener">dva 入门：手把手教你写应用</a><br><a href="https://mobile.ant.design/docs/react/introduce-cn" target="_blank" rel="noopener">antd mobile 快速上手</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://nisonfuture.cn/2018/05/05/less css使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pling Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="叶落林间">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/05/less css使用/" itemprop="url">less css使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-05T00:00:00+08:00">
                2018-05-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/programming/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1、less-是什么"><a href="#1、less-是什么" class="headerlink" title="1、less 是什么"></a>1、less 是什么</h3><ul>
<li>less 类似于使用这个动态样式语言，属于css 预处理语言的一种，它使用类似css的语法，为css富裕了动态语言的特性，如变量、继承、运算、函数，更方便css的编写和维护。</li>
<li>less 可以在多种语言，环境中使用，包括浏览器端，桌面客户端、服务端</li>
</ul>
<h3 id="2、编译工具"><a href="#2、编译工具" class="headerlink" title="2、编译工具"></a>2、编译工具</h3><p>其实不需要我们前端做什么，现成就有工具，只要安装了less，再通过import 文件名.less 就可以使用，在编译的时候会解析。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g less</span><br></pre></td></tr></table></figure>
<h2 id="less-语法"><a href="#less-语法" class="headerlink" title="less 语法"></a>less 语法</h2><h3 id="1-注释"><a href="#1-注释" class="headerlink" title="1 注释"></a>1 注释</h3><ul>
<li>可以使用css中的注释（==/*我会被编译*/==）</li>
<li>也可以使用 ==// 我不会被编译== 注释，这个注释在编译的时候会自动过滤</li>
</ul>
<h3 id="2-变量"><a href="#2-变量" class="headerlink" title="2 变量"></a>2 变量</h3><p>Less中声明变量一定要用@开头，比如：@变量名:值</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 声明变量</span></span><br><span class="line"><span class="variable">@test_width:</span> <span class="number">300px</span>;</span><br><span class="line"><span class="selector-class">.box</span>&#123;</span><br><span class="line">	<span class="comment">// 2. 使用变量</span></span><br><span class="line">	<span class="attribute">width</span>: <span class="variable">@test_width</span>;</span><br><span class="line">	<span class="attribute">height</span>: <span class="variable">@test_width</span>;</span><br><span class="line">	<span class="attribute">border</span>: <span class="number">1px</span> solid white;</span><br><span class="line">	<span class="attribute">background-color</span>: yellow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>它在编译后的css文件中@test_width 就直接替换成300px了。</p>
<h3 id="3-混合-（Mixin）"><a href="#3-混合-（Mixin）" class="headerlink" title="3.混合 - （Mixin）"></a>3.混合 - （Mixin）</h3><ul>
<li>混合（mixin）变量</li>
<li>例如： .border{ border:solid 10px red}</li>
<li>带参数的混合</li>
<li>.border-radius(@radius){css 代码}</li>
<li>可设置默认值</li>
<li>border-radius(@radius：5px）{css 代码}</li>
</ul>
<p>less：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@test_width:</span><span class="number">300px</span>;</span><br><span class="line"><span class="selector-class">.box</span>&#123;</span><br><span class="line">     <span class="comment">//2.使用变量</span></span><br><span class="line">     <span class="attribute">width</span>: <span class="variable">@test_width</span>;</span><br><span class="line">     <span class="attribute">height</span>: <span class="variable">@test_width</span>;</span><br><span class="line">     <span class="attribute">background-color</span>: yellow;</span><br><span class="line"></span><br><span class="line">     <span class="selector-class">.border</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//混合</span></span><br><span class="line"><span class="selector-class">.border</span>&#123;</span><br><span class="line"> <span class="attribute">border</span>: <span class="number">5px</span> solid pink;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box2</span>&#123;</span><br><span class="line">     <span class="selector-class">.box</span>;</span><br><span class="line">     <span class="attribute">margin-left</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>生成的css：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">     <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">     <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">     <span class="attribute">background-color</span>: yellow;</span><br><span class="line">     <span class="attribute">border</span>: <span class="number">5px</span> solid pink;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.border</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">5px</span> solid pink;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box2</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: yellow;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">5px</span> solid pink;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>带参数的混合，Less：</strong></p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//混合 - 可带参数的</span></span><br><span class="line"><span class="selector-class">.border_02</span>(<span class="variable">@border_width</span>)&#123;</span><br><span class="line">     <span class="attribute">border</span>: solid yellow <span class="variable">@border_width</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.test_hunhe</span>&#123;</span><br><span class="line">     <span class="selector-class">.border_02</span>(<span class="number">30px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>带默认值参数的混合，Less：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.border_03</span>(<span class="variable">@border_width</span>:<span class="number">10px</span>)&#123;</span><br><span class="line">     <span class="attribute">border</span>: solid green <span class="variable">@border_width</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.text_hunhe_03</span>&#123;</span><br><span class="line">     <span class="selector-class">.border_03</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在引用.border_03()的时候没有传递值，那么默认的值就是10px。</p>
<h3 id="匹配模式"><a href="#匹配模式" class="headerlink" title="匹配模式"></a>匹配模式</h3><ul>
<li>相当于js 中的if 也不完全是</li>
<li>满足条件后才能匹配</li>
</ul>
<p>我们来看一个话三角形的例子，如果你知道怎么画更好：</p>
<p>HTML：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class= &quot;sanjiao&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>Less:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.sanjiao</span> &#123;</span><br><span class="line">	<span class="attribute">width</span>:<span class="number">0</span>;</span><br><span class="line">	<span class="attribute">height</span>:<span class="number">0</span>;</span><br><span class="line">	<span class="attribute">overflow</span>:hidden;</span><br><span class="line">	<span class="attribute">borfer-width</span>:<span class="number">10px</span>;</span><br><span class="line">     <span class="attribute">border-color</span>: transparent transparent red transparent;</span><br><span class="line">     <span class="attribute">border-style</span>: dashed dashed solid dashed;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这是画一个向上的三角，如果我们要改变三角的朝向，我们得改变border-color，我们得写几遍大部分都一样的代码，而用来模式匹配之后：<br>Less：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//模式匹配</span></span><br><span class="line"><span class="selector-class">.triangle</span>(top,<span class="variable">@width</span>:<span class="number">5px</span>,<span class="variable">@color</span>:<span class="number">#ccc</span>)&#123;</span><br><span class="line">     <span class="attribute">border-width</span>: <span class="variable">@width</span>;</span><br><span class="line">     <span class="attribute">border-color</span>: transparent transparent <span class="variable">@color</span> transparent;</span><br><span class="line">     <span class="attribute">border-style</span>: dashed dashed solid dashed;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.triangle</span>(bottom,<span class="variable">@width</span>:<span class="number">5px</span>,<span class="variable">@color</span>:<span class="number">#ccc</span>)&#123;</span><br><span class="line">     <span class="attribute">border-width</span>: <span class="variable">@width</span>;</span><br><span class="line">     <span class="attribute">border-color</span>: <span class="variable">@color</span> transparent transparent transparent;</span><br><span class="line">     <span class="attribute">border-style</span>: dashed dashed solid dashed;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.triangle</span>(left,<span class="variable">@width</span>:<span class="number">5px</span>,<span class="variable">@color</span>:<span class="number">#ccc</span>)&#123;</span><br><span class="line">     <span class="attribute">border-width</span>: <span class="variable">@width</span>;</span><br><span class="line">     <span class="attribute">border-color</span>: transparent <span class="variable">@color</span> transparent transparent;</span><br><span class="line">     <span class="attribute">border-style</span>: dashed solid dashed dashed;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.triangle</span>(right,<span class="variable">@width</span>:<span class="number">5px</span>,<span class="variable">@color</span>:<span class="number">#ccc</span>)&#123;</span><br><span class="line">     <span class="attribute">border-width</span>: <span class="variable">@width</span>;</span><br><span class="line">     <span class="attribute">border-color</span>: transparent transparent transparent <span class="variable">@color</span>;</span><br><span class="line">     <span class="attribute">border-style</span>: dashed dashed dashed solid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后我们需要什么方向调用的时候就传什么方向：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.sanjiao</span>&#123;</span><br><span class="line">     <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">     <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">     <span class="attribute">overflow</span>: hidden;</span><br><span class="line">     <span class="selector-class">.triangle</span>(right,<span class="number">100px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是，里面的width、heiht又要重写一遍，而Less给我们提供了一个东西，它不管你如何选择什么三角方向，它总会带上那个东西，有点像Java里面的finally块，无论你try块里做了什么，Java始终会执行finally块里的代码，好了，我们来看下Less班的finally如何写：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.triangle</span>(<span class="variable">@_</span>,<span class="variable">@width</span>:<span class="number">5px</span>,<span class="variable">@color</span>:<span class="number">#ccc</span>)&#123;</span><br><span class="line">     <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">     <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">     <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.sanjiao</span>&#123;</span><br><span class="line">     <span class="selector-class">.triangle</span>(right,<span class="number">100px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现了没？就是一个“@”参数！无论你选择top是right方向，带@参数的triangle都会被带上，调用的时候就没必要再写width，height等。</p>
<blockquote>
<p>这个是无论你第一个参数是什么都会匹配到，都会把这里面的css放到需要的地方，说明这个并不是只匹配一个的，可以多个匹配</p>
</blockquote>
<p>如果你觉得上面比较复杂了一点，OK，我们来一个简单的例子，div定位的例子<br>HTML：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"pipei"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>写三个定位，相对定位、绝对定位和固定定位<br>Less：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//匹配模式 - 定位</span></span><br><span class="line"><span class="selector-class">.post</span>(r)&#123;</span><br><span class="line">     <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.post</span>(a)&#123;</span><br><span class="line">     <span class="attribute">position</span>: absolute;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.post</span>(f)&#123;</span><br><span class="line">     <span class="attribute">position</span>: fixed;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pipei</span>&#123;</span><br><span class="line">     <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">     <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">     <span class="attribute">background-color</span>: green;</span><br><span class="line">     <span class="selector-class">.post</span>(r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样，这个div就是相对定位了。</p>
<h3 id="5-运算"><a href="#5-运算" class="headerlink" title="5 运算"></a>5 运算</h3><p>在Less中，任何数组、颜色或者变量都可以参与运算，运算应该被包裹在括号中。例如：+ - * /<br>给宽度增加20px然后在乘以5个像素，<br>Less：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@test_01:</span><span class="number">300px</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box_02</span>&#123;</span><br><span class="line"> <span class="attribute">width</span>: (<span class="variable">@test_01</span> + <span class="number">20</span>) * <span class="number">5</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-嵌套规则"><a href="#6-嵌套规则" class="headerlink" title="6 嵌套规则"></a>6 嵌套规则</h3><p>Less中的嵌套是最有意思的小东西了、我们创建这个一个列表：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Less的嵌套用法<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Less的嵌套用法<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Less的嵌套用法<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Less的嵌套用法<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Less的嵌套用法<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Less：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.list</span>&#123;</span><br><span class="line">   <span class="attribute">width</span>: <span class="number">600px</span>;</span><br><span class="line">   <span class="attribute">margin</span>: <span class="number">30px</span> auto;</span><br><span class="line">   <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">   <span class="attribute">list-style</span>: none;</span><br><span class="line"> </span><br><span class="line">   <span class="selector-tag">li</span>&#123;</span><br><span class="line">       <span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">       <span class="attribute">line-height</span>: <span class="number">30px</span>;</span><br><span class="line">       <span class="attribute">background-color</span>: pink;</span><br><span class="line">       <span class="attribute">margin-bottom</span>: <span class="number">5px</span>;</span><br><span class="line">       <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="selector-tag">a</span>&#123;</span><br><span class="line">       <span class="attribute">float</span>: left;</span><br><span class="line">       <span class="comment">//&amp; 代表它的上一层选择器</span></span><br><span class="line">       <span class="selector-tag">&amp;</span><span class="selector-pseudo">:hover</span>&#123;</span><br><span class="line">             <span class="attribute">color</span>: red;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="selector-tag">span</span>&#123;</span><br><span class="line">         <span class="attribute">float</span>: right;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>它编译后生成的CSS就是这样的：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.list</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">600px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">30px</span> auto;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">list-style</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.list</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: pink;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.list</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.list</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.list</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: right;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7-arguments变量"><a href="#7-arguments变量" class="headerlink" title="7 @arguments变量"></a>7 @arguments变量</h3><p>@arguments包含了所有传递进来的参数。如果你不想单独处理每一个参数的话就可以像这样写：<br>Less：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.border_arg</span>(<span class="variable">@w</span>:<span class="number">30px</span>,<span class="variable">@c</span>:red,<span class="variable">@xx</span>:solid)&#123;</span><br><span class="line">   <span class="attribute">border</span>: <span class="variable">@arguments</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.test_arguments</span>&#123;</span><br><span class="line">   <span class="selector-class">.border_arg</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样@arguments就自动帮我们注入了所有的参数，省了那么一丢丢的代码。</p>
<h3 id="8-避免编译、-important以及总结"><a href="#8-避免编译、-important以及总结" class="headerlink" title="8 避免编译、!important以及总结"></a>8 避免编译、!important以及总结</h3><ul>
<li>有时候我们不需要输出一些不正确的CSS语法或使用一些Less不认识的专有语法。</li>
<li>要输出这样的值，我们可以在字符串前加一个，例如：width:’clac(100% - 35)’</li>
</ul>
<p>less</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.test_03</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: calc(<span class="number">200px</span> - <span class="number">30px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样的话，变异后的css 就自动帮你计算了<br>css</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.test_03</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="built_in">calc</span>(170px);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但我们并不想它在编译时被计算，而是想让浏览器去计算，这时候我们就需要添加~符号了：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.test_03</span>&#123;</span><br><span class="line">     <span class="attribute">width</span>: <span class="string">~'calc(200px - 30px)'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样，就可以避免编译，输出的CSS就是这样（原样输出）</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.test_03</span> &#123;</span><br><span class="line">      <span class="attribute">width</span>: <span class="built_in">calc</span>(200px - 30px);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>!important关键字<br>会为所有混合所带来的样式，添加!important</p>
<h3 id="less-函数"><a href="#less-函数" class="headerlink" title="less 函数"></a>less 函数</h3><p>这是使用了less的unit函数来添加单位，将所有的需要转化的css都写到一个公共的less文件里面，通过@import导入进去。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.fs</span>(<span class="variable">@px</span>) &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: unit(<span class="variable">@px</span> / <span class="number">37.5</span>, rem);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*----- 宽度 -----*/</span></span><br><span class="line"><span class="selector-class">.w</span>(<span class="variable">@px</span>) &#123;</span><br><span class="line">  <span class="attribute">width</span>: unit(<span class="variable">@px</span> / <span class="number">37.5</span>, rem);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*----- 高度 -----*/</span></span><br><span class="line"><span class="selector-class">.h</span>(<span class="variable">@px</span>) &#123;</span><br><span class="line">  <span class="attribute">height</span>: unit(<span class="variable">@px</span> / <span class="number">37.5</span>, rem);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*----- 行高 -----*/</span></span><br><span class="line"><span class="selector-class">.lh</span>(<span class="variable">@px</span>) &#123;</span><br><span class="line">  <span class="attribute">line-height</span>: unit(<span class="variable">@px</span> / <span class="number">37.5</span>, rem);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*----- 背景尺寸 -----*/</span></span><br><span class="line"><span class="selector-class">.b_s</span>(<span class="variable">@px</span>, <span class="variable">@px</span>) &#123;</span><br><span class="line">  <span class="attribute">-webkit-background-size</span>: unit(<span class="variable">@px</span> / <span class="number">37.5</span>, rem) unit(<span class="variable">@px</span> / <span class="number">37.5</span>, rem);</span><br><span class="line">  <span class="attribute">background-size</span>: unit(<span class="variable">@px</span> / <span class="number">37.5</span>, rem) unit(<span class="variable">@px</span> / <span class="number">37.5</span>, rem);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* [背景尺寸，设置宽度，高度auto]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="selector-class">.b_s1</span>(<span class="variable">@px</span>) &#123;</span><br><span class="line">  <span class="attribute">-webkit-background-size</span>: unit(<span class="variable">@px</span> / <span class="number">37.5</span>, rem) auto;</span><br><span class="line">  <span class="attribute">background-size</span>: unit(<span class="variable">@px</span> / <span class="number">37.5</span>, rem) auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.b_s2</span>(<span class="variable">@px</span>) &#123;</span><br><span class="line">  <span class="attribute">-webkit-background-size</span>: auto unit(<span class="variable">@px</span> / <span class="number">37.5</span>, rem);</span><br><span class="line">  <span class="attribute">background-size</span>: auto unit(<span class="variable">@px</span> / <span class="number">37.5</span>, rem);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*----- margin -----*/</span></span><br><span class="line"><span class="selector-class">.mt</span>(<span class="variable">@px</span>) &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: unit(<span class="variable">@px</span> / <span class="number">37.5</span>, rem);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.mr</span>(<span class="variable">@px</span>) &#123;</span><br><span class="line">  <span class="attribute">margin-right</span>: unit(<span class="variable">@px</span> / <span class="number">37.5</span>, rem);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.mb</span>(<span class="variable">@px</span>) &#123;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: unit(<span class="variable">@px</span> / <span class="number">37.5</span>, rem);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.ml</span>(<span class="variable">@px</span>) &#123;</span><br><span class="line">  <span class="attribute">margin-left</span>: unit(<span class="variable">@px</span> / <span class="number">37.5</span>, rem);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="在其他less文件里面使用"><a href="#在其他less文件里面使用" class="headerlink" title="在其他less文件里面使用"></a>在其他less文件里面使用</h3><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@import</span> <span class="string">"../less/bass.less"</span>;</span><br><span class="line"><span class="selector-class">.sort-title</span> &#123;</span><br><span class="line">  <span class="selector-class">.fs</span>(<span class="number">17</span>);</span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">@color0</span>;</span><br><span class="line">  <span class="attribute">font-family</span>: PingFang-SC-Medium;</span><br><span class="line">  <span class="selector-class">.mt</span>(<span class="number">20</span>);</span><br><span class="line">  <span class="selector-class">.mb</span>(<span class="number">15</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>参考链接：<a href="https://www.jianshu.com/p/d24b4df21d07" target="_blank" rel="noopener">LESS CSS使用及语法入门</a></p>
<p>参考链接：<a href="https://segmentfault.com/a/1190000012878202" target="_blank" rel="noopener">移动端布局（less+rem）</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://nisonfuture.cn/2018/05/03/移动端页面适配/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pling Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="叶落林间">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/03/移动端页面适配/" itemprop="url">移动端页面适配</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-03T00:00:00+08:00">
                2018-05-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/programming/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>本文参考于 <a href="https://www.jianshu.com/p/3b45aa981e77" target="_blank" rel="noopener">keenjaan</a>的一篇文章 ，还有 <a href="https://www.quirksmode.org/mobile/viewports.html" target="_blank" rel="noopener">ppk</a> 的几篇文章</p>
</blockquote>
<blockquote>
<p>最近要做一个移动端的项目，类似于webapp 对移动端适配要求比较高，所以想学习一下移动端适配的方案，之后遇到的坑，没那么多。这几天找了很多资料，对于移动端的适配有不同的见解，也有挺多不同的方案可以实现，但是都离不开一个人比较重要的概念 <strong>viewport</strong><br>其实我现在也不知道这个是什么，之前在手机端都是直接用了，没有考虑那么多，现在回头看去，自己之前的项目挺小的，对这个的要求不高。<br>所以现在来学习一下，我也不太懂，也只是做个记录，如有错误还请指教。</p>
</blockquote>
<p>先来看看一些基本概念：</p>
<h2 id="像素："><a href="#像素：" class="headerlink" title="像素："></a>像素：</h2><h3 id="1、-物理像素（设备像素）"><a href="#1、-物理像素（设备像素）" class="headerlink" title="1、 物理像素（设备像素）"></a>1、 物理像素（设备像素）</h3><p>屏幕的物理相熟，又被称为设备像素，他是显示设备中一个最微小的物理部件，出厂的时候就已经固定，<br>我个人的理解 就像是点阵，出厂的时候， 点的数目就已经固定了</p>
<p><img src="./images/1525336288279.jpg" alt="点阵"></p>
<h3 id="2、-设备独立像素"><a href="#2、-设备独立像素" class="headerlink" title="2、 设备独立像素"></a>2、 设备独立像素</h3><p>设备独立像素也称为密度无关像素，可以认为是计算机坐标系统中的一个点，这个点代表一个可以由程序使用的虚拟像素（比如说css像素），然后有相关系统转换为物理像素。</p>
<p>我个人理解 就像是给开发者使用的像素单位，就像\<div style="width: 100px; ">\</div> 这个里面的px，就是s被独立像素，但是这个1px 对应多少个点，就是通过设置 <strong>设备像素比</strong>来确定</p>
<h3 id="3、-设备像素比"><a href="#3、-设备像素比" class="headerlink" title="3、 设备像素比"></a>3、 设备像素比</h3><p>设备像素比简称为dpr，其定义了物理像素和设备独立像素的对应关系</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">设别像素比 =  物理像素  / 设备独立像素</span><br><span class="line">以iPhone6 为例：</span><br><span class="line">iPhone6 的设别宽高为<span class="number">375</span>pt * <span class="number">667</span>pt，可以理解为设备的独立像素，而其设备像素比为<span class="number">2</span>，固定设备像素为<span class="number">750</span>pt * <span class="number">1334</span>pt</span><br></pre></td></tr></table></figure>
<p>通过： window.devicePiexelRatio 获得。</p>
<p>设备像素比是 区别 高清片的标准，dpr大于一 就为高清屏，一般情况下 dpr 为整数，但是安卓有些奇葩机型不为整数</p>
<h3 id="4、-css像素"><a href="#4、-css像素" class="headerlink" title="4、 css像素"></a>4、 css像素</h3><p>在CSS, JS 中使用的一个长度单位 –px</p>
<p>注： 在pc端1物理像素等于1px,1物理像素与px的关系与以下因素相关。（有些视口概念，可以把下面视口概念看完再来）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 屏幕布局视口大小</span><br><span class="line"><span class="number">2.</span> 屏幕分辨率（物理像素）</span><br></pre></td></tr></table></figure>
<p>对于一块屏幕，其物理像素是确定的。视觉视口尺寸是继承的布局视口的，而视觉视口的宽度即是css的px数。所以在一块屏上物理像素与px的关系就是物理像素与布局视口的px数的关系。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">比如iphone6，期物理像素为<span class="number">750</span>，如果没有设置布局视口时，viewport为<span class="number">980</span>px</span><br><span class="line">此时：<span class="number">1</span>物理像素长度等于<span class="number">980</span>/<span class="number">750</span>px = <span class="number">1.3067</span>px的长度</span><br><span class="line">由于像素都是点阵的，故<span class="number">1</span>物理像素相当于<span class="number">1.3067</span>px * <span class="number">1.3067</span>px方格。</span><br><span class="line">当在meta中设置了如下配置时</span><br><span class="line">&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width"</span>&gt;</span><br><span class="line">相当于把布局视口设置为设备的宽度(即上面讲到的设备独立像素)， 对于iphone6就是<span class="number">375</span>px。</span><br><span class="line">此时<span class="number">1</span>物理像素长度等于<span class="number">375</span>/<span class="number">750</span>px = <span class="number">0.5</span>px的长度，故<span class="number">1</span>物理像素相当于<span class="number">0.5</span>px * <span class="number">0.5</span>px的方格。</span><br></pre></td></tr></table></figure>
<h2 id="视口："><a href="#视口：" class="headerlink" title="视口："></a>视口：</h2><h3 id="1、-布局视口"><a href="#1、-布局视口" class="headerlink" title="1、 布局视口"></a>1、 布局视口</h3><p>在html中 一般在meta的name为viewport字段就是控制的布局视口。布局视口一般都是浏览器厂商给的一个值。在手机互联网没有普及前，网络上绝大部分页面都是为电脑端浏览而做的，根本没有做移动端的适配。随着移动端的发展，在手机上看电脑端的页面已成为非常普及现象。而电脑端页面宽度较大，移动端宽度有限，要想看到整个网页，会有很长的滚动条，看起来非常麻烦。于是浏览器厂商为了让用户在小屏幕下网页也能够显示地很好，所以把布局视口设置的很大，一般在768px ~ 1024px 之间，最常用的宽度就是 980。这样用户就能看到绝大部分内容，并根据具体内容选择缩放。</p>
<p>故布局视口是看不见的，浏览器厂商设置的一个固定值，如980px，并将980px的内容缩放到手机屏内。</p>
<p>布局视口可以通过：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.documentElement.clientWidth(clientHeight) <span class="comment">// 布局视口的尺寸。</span></span><br></pre></td></tr></table></figure>
<p><img src="./images/1525427748530.jpg" alt="布局视口"></p>
<h3 id="2、视觉视口："><a href="#2、视觉视口：" class="headerlink" title="2、视觉视口："></a>2、视觉视口：</h3><p>浏览器可视区域的大小，即用户看到的网页的区域。(其宽度继承的布局视口宽度)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.innerWidth(innerHeight)  <span class="comment">// 视觉视口尺寸</span></span><br></pre></td></tr></table></figure>
<p><img src="./images/1525427708623.jpg" alt="视觉窗口"></p>
<h3 id="3、理想视口"><a href="#3、理想视口" class="headerlink" title="3、理想视口:"></a>3、理想视口:</h3><p>布局视口虽然解决了移动端查看pc端网页的问题，但是完全忽略了手机本身的尺寸。所以苹果引入了理想视口，它对设备来说是最理想的布局视口，用户不需要对页面进行缩放就能完美的显示整个页面。最简单的做法就是使布局视口宽度改成屏幕的宽度。</p>
<p>可以通过window.screen.width获取。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width"</span>&gt;</span><br></pre></td></tr></table></figure>
<p>移动端到底怎么适配不同的屏幕呢？最简单的方法是设置如下视口：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width,initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"</span>&gt;</span><br></pre></td></tr></table></figure>
<p>当使用以上方案定义布局视口时，即布局视口等于理想视口（屏幕宽度），屏幕没有滚动条，不存在高清屏下，字体较小的问题。但是在不同屏幕上，其视觉宽度是不同的，不能简单的将所有的尺寸都设置为px，可能会出现滚动条。小尺寸的可以用px，大尺寸的只能用百分比和弹性布局。</p>
<h3 id="viewport-缩放"><a href="#viewport-缩放" class="headerlink" title="viewport 缩放"></a>viewport 缩放</h3><p>对于 上面的设置，css像素对应的物理像素具数不一致的。</p>
<p>在普通屏幕下，dpr=1时，</p>
<p>1个css香酥鸭长度对应一个物理像素长度， 1个css像素对应1个物理像素。</p>
<p>而在retina 屏幕下，如果dpr = 2 </p>
<p>1个css像素长度对应两个物理像素长度，1个css像素，对应4个物理像素。</p>
<p>此时，如果css 中这样写：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">border: 1px solid red; // 此时 1px 对应的宽度是2个物理像素的宽度</span><br></pre></td></tr></table></figure>
<p>而一般现在的移动端设计稿 都是给予iphone 设计的，稿子一般为 750px 或 640px，这正好是 iphone6 和iphone5 的物理像素。在设计稿中，一般有边框效果，这时边框的线宽为1px，对应的是一个物理像素。而对于Iphone6/5 来说，当width=device-width 时，css的1px显示出来的是2个物理像素，所以线看起来比较粗. </p>
<p>解决办法： 其中一种方式是设置缩放 viewport  </p>
<p>initial-sacale 是将布局视口进行缩放，initial-scale 是相对于理想视口的，即 initial-scale=1 与 width = device-width 是以一样的效果。initial-scale = 0.5 等效于 width= 2倍的 device-width ，所以设置initial-scale和width都可以改变布局视口的大小。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name="viewport" content="width=device-width,initial-scale=0.5, maximum-scale=0.5, minimum-scale=0.5, user-scalable=no"&gt;</span><br></pre></td></tr></table></figure>
<p>对于iphone6当添加如上设置后，initial-scale=0.5,即将页面缩小2倍后等于屏幕宽度。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">布局视口<span class="selector-tag">width</span>:</span><br><span class="line">width / 2 = 375px; width = 750px;</span><br></pre></td></tr></table></figure>
<p>所以这个时候布局视口为750排序， 1px等于1个物理像素。</p>
<h2 id="适配方案"><a href="#适配方案" class="headerlink" title="适配方案"></a>适配方案</h2><p>对于UI设计师，给的一张设计稿，怎样将其还原到也饿面上？ 对于不同的收集拍屏幕，其dpr不同，屏幕尺寸也不同，烤炉到各种情况，有很多适配方案，所以不同的适配方案，实现方法不同，处理复杂度也不同，还原程度也不同。</p>
<h3 id="方案一"><a href="#方案一" class="headerlink" title="方案一"></a>方案一</h3><p>固定高度，宽度自适应。</p>
<p>这种方案是目前使用比较多的方案也是相对较简单的实现方案：</p>
<p>该方案使用了理想视口：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"&gt;</span><br></pre></td></tr></table></figure>
<p>垂直方向使用固定值，水平方向使用弹性布局，元素采用定制、百分比、flex布局等。这种方案相对简单，还原度也非常低。</p>
<p>我之前所采用的方式就是这种方案，感觉很麻烦，我还要通过media 查询 适配不同的尺寸，改变flex的流向等等。</p>
<h3 id="方案二："><a href="#方案二：" class="headerlink" title="方案二："></a>方案二：</h3><p>固定的布局视口宽度，使用viewport 进行缩放</p>
<p>如： <a href="https://link.jianshu.com/?t=http://m.lizhi.fm/" target="_blank" rel="noopener">荔枝FM</a>  、<a href="https://link.jianshu.com/?t=https://m.163.com/apps" target="_blank" rel="noopener">网易应用</a></p>
<p>荔枝的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">if(/Android (\d+\.\d+)/.test(navigator.userAgent))&#123;</span><br><span class="line">  var version = parseFloat(RegExp.$1);</span><br><span class="line">  if(version&gt;2.3)&#123;</span><br><span class="line">    var phoneScale = parseInt(window.screen.width)/640;</span><br><span class="line">    if(/MZ-M571C/.test(navigator.userAgent))&#123;</span><br><span class="line">      document.write(&apos;&lt;meta name=&quot;viewport&quot; content=&quot;width=640, minimum-scale = 0.5, maximum-scale= 0.5&quot;&gt;&apos;);</span><br><span class="line">    &#125;else if(/M571C/.test(navigator.userAgent)&amp;&amp;/LizhiFM/.test(navigator.userAgent))&#123;</span><br><span class="line">      document.write(&apos;&lt;meta name=&quot;viewport&quot; content=&quot;width=640, minimum-scale = 0.5, maximum-scale= 0.5&quot;&gt;&apos;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      document.write(&apos;&lt;meta name=&quot;viewport&quot; content=&quot;width=640, minimum-scale = &apos;+ phoneScale +&apos;, maximum-scale = &apos;+ phoneScale +&apos;, target-densitydpi=device-dpi&quot;&gt;&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    document.write(&apos;&lt;meta name=&quot;viewport&quot; content=&quot;width=640, target-densitydpi=device-dpi&quot;&gt;&apos;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">  document.write(&apos;&lt;meta name=&quot;viewport&quot; content=&quot;width=640, user-scalable=no, target-densitydpi=device-dpi&quot;&gt;&apos;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>网易应用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">var win = window,</span><br><span class="line">        width = 640,</span><br><span class="line">        iw = win.innerWidth || width,</span><br><span class="line">        ow = win.outerHeight || iw,</span><br><span class="line">        sw = win.screen.width || iw,</span><br><span class="line">        saw = win.screen.availWidth || iw,</span><br><span class="line">        ih = win.innerHeight || width,</span><br><span class="line">        oh = win.outerHeight || ih,</span><br><span class="line">        ish = win.screen.height || ih,</span><br><span class="line">        sah = win.screen.availHeight || ih,</span><br><span class="line">        w = Math.min(iw, ow, sw, saw, ih, oh, ish, sah),</span><br><span class="line">        ratio = w / width,</span><br><span class="line">        dpr = win.devicePixelRatio;</span><br><span class="line">        if (ratio = Math.min(ratio, dpr), 1 &gt; ratio) &#123;</span><br><span class="line">            var ctt = &quot;,initial-scale=&quot; + ratio + &quot;,maximum-scale=&quot; + ratio,</span><br><span class="line">                metas = document.getElementsByTagName(&quot;meta&quot;);ctt += &quot;&quot;;</span><br><span class="line">            for (var i = 0, meta; i &lt; metas.length; i++) meta = metas[i], &quot;viewport&quot; == meta.name &amp;&amp; (meta.content += ctt)</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>固定布局视口，宽度设置固定的值，总宽度为640px，根据屏幕宽度动态生成viewport。（设计稿应该是640px的）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=640, minimum-scale = 0.5625, maximum-scale = 0.5625, target-densitydpi=device-dpi&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>这种方式布局如荔枝FM的网页宽度始终为640px。缩放比例scale为：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> scale = <span class="built_in">window</span>.screen.width / <span class="number">640</span></span><br></pre></td></tr></table></figure>
<p>设计稿为640px时，正好可以1:1以px来写样式。但是1px所对应的物理像素就不一定是1了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="built_in">window</span>.screen.width * dpr) / <span class="number">640</span>   <span class="comment">// 1px对应的物理像素</span></span><br></pre></td></tr></table></figure>
<p><img src="./images/1525399218043.jpg" alt="iphone5.png"></p>
<p><img src="./images/1525399234438.jpg" alt="iphone6.png"></p>
<h3 id="方案三："><a href="#方案三：" class="headerlink" title="方案三："></a>方案三：</h3><p>根据不同屏幕动态写入font-size，以rem为宽度单位，固定布局视口。</p>
<p>如<a href="http://3g.163.com/touch/all?dataversion=B#/" target="_blank" rel="noopener">网易新闻</a>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width,initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"</span>&gt;</span><br></pre></td></tr></table></figure>
<p>以640px设计稿和750px的视觉稿，网易这样处理的：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> width = <span class="built_in">document</span>.documentElement.clientWidth;   <span class="comment">// 屏幕的布局视口宽度</span></span><br><span class="line"><span class="keyword">var</span> rem = width / <span class="number">7.5</span>;                              <span class="comment">// 750px设计稿将布局视口分为7.5份</span></span><br><span class="line"><span class="keyword">var</span> rem = width / <span class="number">6.4</span>;                              <span class="comment">// 640px设计稿将布局视口分为6.4份</span></span><br></pre></td></tr></table></figure>
<p>这样不管是750px设计稿还是640px设计稿，1rem 等于设计稿上的100px。故px转换rem时：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rem = px * <span class="number">0.01</span>;</span><br></pre></td></tr></table></figure>
<p>在750px设计稿上：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">75</span>px 对应 <span class="number">0.75</span>rem, 距离占设计稿的<span class="number">10</span>%；</span><br><span class="line"></span><br><span class="line">在ipone6上：</span><br><span class="line">width = <span class="built_in">document</span>.documentElement.clientWidth = <span class="number">375</span>px；</span><br><span class="line">rem = <span class="number">375</span>px / <span class="number">7.5</span> = <span class="number">50</span>px;</span><br><span class="line"><span class="number">0.75</span>rem = <span class="number">37.5</span>px;   (<span class="number">37.5</span>/<span class="number">375</span>=<span class="number">10</span>%；占屏幕<span class="number">10</span>%)</span><br><span class="line">                     </span><br><span class="line">在ipone5上：</span><br><span class="line">width = <span class="built_in">document</span>.documentElement.clientWidth = <span class="number">320</span>px；</span><br><span class="line">rem = <span class="number">320</span>px / <span class="number">7.5</span> = <span class="number">42.667</span>px;</span><br><span class="line"><span class="number">0.75</span>rem = <span class="number">32</span>px; (<span class="number">32</span>/<span class="number">320</span>=<span class="number">10</span>%；占屏幕<span class="number">10</span>%)</span><br></pre></td></tr></table></figure>
<p>故对于设计稿上任何一个尺寸换成rem后，在任何屏下对应的尺寸占屏幕宽度的百分比相同。故这种布局可以百分比还原设计图。</p>
<p><img src="./images/1525400738683.jpg" alt="iphone5-2.png"></p>
<p><img src="./images/1525400759542.jpg" alt="iphone6-2.png"></p>
<h3 id="方案四："><a href="#方案四：" class="headerlink" title="方案四："></a>方案四：</h3><p>以rem作为宽度单位，动态写入viewport和font-size进行缩放。</p>
<p>根据设置的dpr设置font-size。如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.documentElement.style.fontSize = <span class="number">50</span> * dpr;</span><br><span class="line"><span class="comment">// dpr 为设置的设备像素比。（注意不是设备自身的设备像素比，而是认为设置的dpr）</span></span><br></pre></td></tr></table></figure>
<p>这种情况下，dpr = 1时，1rem = 50px;</p>
<p>dpr = 2时， 1rem = 100px;</p>
<p>当设计以iphone6为标准，出750px的设计稿时，此时dpr=2，故1rem 等于100px，将图上的尺寸转换为rem非常方便，除以100就行。代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">var scale             = 1.0;</span><br><span class="line">var dpr             = 1;</span><br><span class="line">var isAndroid         = window.navigator.appVersion.match(/android/gi);</span><br><span class="line">var isIPhone          = window.navigator.appVersion.match(/iphone/gi);</span><br><span class="line">var devicePixelRatio  = window.devicePixelRatio;</span><br><span class="line">// 此处只简单对ios做了伸缩处理，安卓没有做伸缩处理，统一dpr = 1</span><br><span class="line">if ( isIPhone ) &#123;</span><br><span class="line">  scale /= devicePixelRatio;</span><br><span class="line">  dpr *= devicePixelRatio;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var viewport        = document.getElementById(&apos;viewport&apos;);</span><br><span class="line">var content         = &apos;initial-scale=&apos; + scale + &apos;, maximum-scale=&apos; + scale + &apos;,minimum-scale=&apos; + scale + &apos;, width=device-width, user-scalable=no&apos;;</span><br><span class="line"></span><br><span class="line">viewport.setAttribute( &apos;content&apos;, content );</span><br><span class="line">document.documentElement.style.fontSize = 50 * dpr + &apos;px&apos;;</span><br><span class="line">document.documentElement.setAttribute(&apos;data-dpr&apos;, dpr);</span><br></pre></td></tr></table></figure>
<p>对于该方案：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">假设肉眼看到的宽度（视觉宽度）：visualWidth,令dpr=1时，其1rem对应的宽度为50.</span><br><span class="line"></span><br><span class="line">dpr = 1 时， 1rem = 50px, initial-scale=1, 缩放为1。</span><br><span class="line">visualWidth = 50 * 1 = 50;</span><br><span class="line"></span><br><span class="line">dpr = 2 时， 1rem = 100px, initial-scale=0.5, 缩放为0.5。</span><br><span class="line">visualWidth = 100 * 0.5 = 50;</span><br><span class="line"></span><br><span class="line">dpr = 3 时， 1rem = 150px, initial-scale=0.3333, 缩放为0.3333。</span><br><span class="line">visualWidth = 150 * 0.3333 = 50;</span><br></pre></td></tr></table></figure>
<p>所以该方案，1rem在所有屏幕上对应的肉眼距离相同，故不同屏幕下，总的rem数不同，大屏下总的rem数大于小屏下，如iphone6下，总宽度为7.5rem，iphone5下，总宽度为6.4rem。故此方案不能百分比还原设计稿，故写样式时，对于大块元素应该用百分比，flex等布局，不能直接用rem。</p>
<p>关于这个方案的详细教程请参考这篇文章<a href="https://www.jianshu.com/p/985d26b40199" target="_blank" rel="noopener">传送门</a></p>
<p><img src="./images/1525401139331.jpg" alt="iPhone5-3"></p>
<p><img src="./images/1525401196938.jpg" alt="iphone6-3"></p>
<h3 id="方案五："><a href="#方案五：" class="headerlink" title="方案五："></a>方案五：</h3><p>根据不同屏幕动态写入font-size和viewport，以rem作为宽度单位</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var width = document.documentElement.clientWidth;   // 屏幕的布局视口宽度</span><br><span class="line">var rem = width / 10;                               // 将布局视口分为10份</span><br></pre></td></tr></table></figure>
<p>这样在任何屏幕下，总长度都为10rem。1rem对应的值也不固定，与屏幕的布局视口宽度有关。</p>
<p>对于动态生成viewport，他们原理差不多，根据dpr来设置缩放。看看淘宝的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">var devicePixelRatio = window.devicePixelRatio;</span><br><span class="line">var isIPhone = window.navigator.appVersion.match(/iphone/gi);</span><br><span class="line">var dpr,scale;</span><br><span class="line">if (isIPhone) &#123;</span><br><span class="line">  if (devicePixelRatio &gt;=3) &#123;</span><br><span class="line">    dpr = 3;</span><br><span class="line">  &#125; else if (devicePixelRatio &gt;=2) &#123;</span><br><span class="line">    dpr = 2;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    dpr = 1;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">  dpr = 1;</span><br><span class="line">&#125;</span><br><span class="line">scale = 1 / dpr;</span><br></pre></td></tr></table></figure>
<p>淘宝只对iphone做了缩放处理，对于android所有dpr=1，scale=1即没有缩放处理。</p>
<p>此方案与方案三相似，只是做了viewport缩放，能百分比还原设计稿。</p>
<p><img src="./images/1525401404961.jpg" alt="iphone5-4"></p>
<p><img src="./images/1525401426281.jpg" alt="iphone6-4"></p>
<h3 id="适配中要解决的问题-："><a href="#适配中要解决的问题-：" class="headerlink" title="适配中要解决的问题 ："></a>适配中要解决的问题 ：</h3><p>移动端适配最主要的是使在不同屏幕下不用所望网页就能正常显示整个页面。以上方案都完成了这一需求。其次有几个需求：</p>
<ol>
<li><p>解决高清屏幕下 1px的问题，</p>
<p>   其实有很多hack方法，这列只讲了缩放视口。先将布局视口设置为高清屏的物理像素。这样 css中1px就是1个物理像素，这样看到的线条才是1px。 但是此时视口宽度大于设备宽度，就回出现滚动条。故对视口进行缩放，是视口宽度缩放到设备的宽度。</p>
<p> 淘宝团队在处理安卓端的缩放存在很多问题，所以dpr 都做1处理，所以安卓端没有解决1px问题。</p>
</li>
<li><p>在大屏手机中一行看到的段落文字应该比小屏手机的多。</p>
<p> 由于淘宝的网易新闻rem都是百分比，故用rem一行显示的文字个数应该是相同的，故对于段落文本不能用rem作为单位，应该用px处理，对于不同的dpr下设置不同的字体。</p>
</li>
</ol>
<blockquote>
<p>这里面的data-dpr 我一开始也不知道是什么 但是后来详细看了 是在前面设置的一个属性 代表缩放比</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.selector &#123; </span><br><span class="line">  color: red; </span><br><span class="line">  font-size: 14px; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[data-dpr=&quot;2&quot;] .selector &#123; </span><br><span class="line">  font-size: 28px; // 14 * 2</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">[data-dpr=&quot;3&quot;] .selector &#123; </span><br><span class="line">  font-size: 42px; // 14 * 3</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="五种方案对比："><a href="#五种方案对比：" class="headerlink" title="五种方案对比："></a>五种方案对比：</h3><p>上面四种方案对设计稿还原程度是有差别的。</p>
<p>除了方案一和方案四以外，其他方案都是百分比还原设计稿，大屏下元素的尺寸就大。</p>
<p>方案一还原设计稿程度较低，这里不做说明。</p>
<p>方案二做了百分比适配，部分1px适配，没有字体适配。</p>
<p>方案三做了百分比适配，没有1px适配，有字体大小适配。</p>
<p>方案四没有做百分百适配，布局要用百分百和flex布局，做了1px的适配，并且对于段落文字直接可以用rem做单位，不需要做适配。</p>
<p>方案五做了百分比适配，有1px适配，有字体大小适配。</p>
<p>项目中遇到的问题：</p>
<p>在我们项目中方案四和方案五都用过。</p>
<p>方案五在使用中没有遇到什么问题，就是刚开始没有做字体适配都是用的rem，后面加入了字体适配，这种方案设计师相对轻松些，不用考虑在大小屏幕下的布局效果。</p>
<p>方案四时没有跟ui设计师沟通清楚，导致设计师在设计图上一行排了很多交互元素，在小屏下放不下去，又不能简单放百分比（元素里的文字放不下）。所以还是要做动态判断大小屏，做出相应适配。这个方案可能设计师需要考虑的多些，尽量减少一行内的交互元素，当一行交互元素多时要考虑小屏手机怎么适配。</p>
<p>其实对于1px的适配在苹果端很好，在android端各个厂商手机差别太大，适配有很多问题。这是为什么绝大多数方案里都放弃了android端1px适配。不过最近看到很多网站都用了densitydpi=device-dpi这个安卓的私有属性来兼容部分安卓机型，这个属性在新的webkit已经被移除了，使用它主要为了兼容低版本的android系统。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Pling Huang</p>
              <p class="site-description motion-element" itemprop="description">个人学习笔记，仅供本人复习</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">70</span>
                  <span class="site-state-item-name">Artikel</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">Kategorien</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">21</span>
                  <span class="site-state-item-name">Tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Pling Huang</span>

  
</div>


  <div class="powered-by">Erstellt mit  <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
